
units  real
dimension       3
atom_style full
boundary        p p p

bond_style harmonic
angle_style hybrid harmonic charmm tbaserestr
dihedral_style charmm/omp
improper_style harmonic
pair_style lj/charmm/coul/long 10.0 12.0 12
pair_modify mix arithmetic
special_bonds charmm
read_data lmp_dat.txt

pair_coeff 17 31 0.102434 2.82417

kspace_style pppm 1.0e-4
variable out1 equal time
compute paPE all pe/atom
compute pe all reduce sum c_paPE
group dna type 1:30
group ions type 31
group eth type 0:0
group water type 32 33
group i1 id 1268
group i1s subtract ions i1
group i2 id 1259 1260 1261 1262 1263 1264 1265 1266 1267 1269 1270 1271 1272 1273 1274 1275 1276 1277 1278 1279 1280 1281 1282 1283 1284 1285 1286 1287 1288 1289 1290 1291 1292 1293 1294 1295 1296
group i2s subtract ions i2
compute 1 dna group/group dna kspace yes
compute 2 dna group/group ions kspace yes
compute 3 dna group/group water kspace yes
compute 4 dna group/group eth kspace yes
compute 5 ions group/group ions kspace yes
compute 6 ions group/group water kspace yes
compute 7 ions group/group eth kspace yes
compute 8 water group/group water kspace yes
compute 9 water group/group eth kspace yes
compute 10 eth group/group eth kspace yes
compute dnaintr dna pe/atom bond angle dihedral improper
compute sdnaintr dna reduce sum c_dnaintr
compute ethintr eth pe/atom bond angle dihedral improper
compute sethintr eth reduce sum c_ethintr
compute watintr water pe/atom bond angle
compute swatintr water reduce sum c_watintr
variable 1t equal c_1+c_sdnaintr
variable 8t equal c_8+c_swatintr
variable 10t equal c_10+c_sethintr

fix o1 all ave/time 1 1 1 v_out1 v_1t c_2 c_3 c_4 c_5 c_6 c_7 v_8t c_9 v_10t c_pe  &
                   file tmpresfull.txt title1 "step time DNASelf DNA-Ions DNA-Water DNA-Ethanol IonsSelf Ions-Water Ions-Ethanol WaterSelf Water-Ethanol EthanolSelf Total"
compute i1s i1 group/group i1 kspace yes
compute i1cr i1 group/group i1s kspace yes
variable i1ion equal c_i1s+c_i1cr/2
compute i1dna i1 group/group dna kspace yes
compute i1eth i1 group/group eth kspace yes
compute i1wat i1 group/group water kspace yes
compute i2s i2 group/group i2 kspace yes
compute i2cr i2 group/group i2s kspace yes
variable i2ion equal c_i2s+c_i2cr/2
compute i2dna i2 group/group dna kspace yes
compute i2eth i2 group/group eth kspace yes
compute i2wat i2 group/group water kspace yes

fix o2 all ave/time 1 1 1 v_out1 v_i1ion c_i1dna c_i1wat c_i1eth v_i2ion c_i2dna c_i2wat c_i2eth  &
                   file tmpresperpock.txt title1 "step time O4'Cr_ion dna wat eth Bulk_ion dna wat eth"
run 0
